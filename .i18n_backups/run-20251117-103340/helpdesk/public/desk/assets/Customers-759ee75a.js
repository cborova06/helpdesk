import{d as D,m as A,n as q,p as F,W as L,Q as g,q as l,k as h,g as r,w as _,h as o,r as x,e as C,l as i,bh as N,z as I,I as E,c as k,au as P,f as R,v as T,y as H,A as b,K,S as O}from"./index-0570e060.js";import{L as Q}from"./LayoutHeader-6b26ba5d.js";import{_ as W}from"./ListViewBuilder.vue_vue_type_script_setup_true_lang-38f9156f.js";import{_ as M}from"./Avatar.vue_vue_type_script_setup_true_lang-a0f98d49.js";import{u as j}from"./pageMeta-7d9b9003.js";import{F as G}from"./FileUploader-6d719bf4.js";import"./Dropdown-1e1fbbdd.js";import"./TabButtons-1f731739.js";import"./description-95dce134.js";import"./TypingIndicator.vue_vue_type_style_index_0_scoped_3f215bd3_lang-f290abcf.js";import"./dayjs-2cebe90e.js";import"./DateTimePicker-2f0425b4.js";import"./useDatePicker-b1fa65c5.js";import"./DateRangePicker.vue_vue_type_script_setup_true_lang-237a353f.js";import"./Link-3bf01fe5.js";import"./StarRating.vue_vue_type_script_setup_true_lang-ecf3e22e.js";import"./NestedPopover-cbe976a0.js";import"./portal-8b8b74e3.js";import"./MultipleAvatar.vue_vue_type_script_setup_true_lang-1c7f3694.js";import"./ticketStatus-329a9615.js";const J={class:"space-y-4"},X={class:"space-y-1"},Y={class:"space-y-1"},Z={class:"float-right flex space-x-2"},ee=D({__name:"NewCustomerDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:A(["customerCreated"],["update:modelValue"]),setup(V,{emit:m}){const u=m,d=q(V,"modelValue"),t=F({customer:"",domain:""}),s=L({url:"frappe.client.insert",method:"POST",data:{doc:{doctype:"HD Customer",customer_name:t.customer,domain:t.domain}},onSuccess:()=>{t.customer="",t.domain="",g.success(l("Customer created")),u("customerCreated")},onError:p=>{g.error(p.messages[0])}});function f(){if(!t.customer){g.error(l("Customer name is required"));return}s.submit({doc:{doctype:"HD Customer",customer_name:t.customer,domain:t.domain}})}return(p,a)=>{const e=x("Button");return C(),h("div",null,[r(o(E),{modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=n=>d.value=n),options:{title:"Add New Customer",size:"sm"}},{"body-content":_(()=>[i("div",J,[i("div",X,[r(o(N),{modelValue:t.customer,"onUpdate:modelValue":a[0]||(a[0]=n=>t.customer=n),label:o(l)("Customer Name"),type:"text",placeholder:o(l)("Tesla Inc.")},null,8,["modelValue","label","placeholder"])]),i("div",Y,[r(o(N),{modelValue:t.domain,"onUpdate:modelValue":a[1]||(a[1]=n=>t.domain=n),label:o(l)("Domain"),type:"text",placeholder:o(l)("eg: tesla.com, mycompany.com")},null,8,["modelValue","label","placeholder"])]),i("div",Z,[r(e,{label:o(l)("Add"),theme:"gray",variant:"solid",onClick:I(f,["prevent"])},null,8,["label"])])])]),_:1},8,["modelValue"])])}}}),oe={class:"flex flex-col items-center gap-4 p-6"},te={class:"text-xl font-medium text-gray-900"},ae={class:"flex gap-2"},le=D({__name:"CustomerDialog",props:{name:{type:String,required:!0}},emits:["customer-updated"],setup(V,{emit:m}){const u=V,d=m,t=k({get(){var e;return(e=s.doc)==null?void 0:e.domain},set(e){s.doc.domain=e}}),s=P({doctype:"HD Customer",name:u.name,auto:!0,setValue:{onSuccess(){g.success(l("Customer updated"))},onError(){g.error(l("Error updating customer"))}}}),f=k(()=>{var e;return{title:(e=s.doc)==null?void 0:e.name,actions:[{label:l("Save"),theme:"gray",variant:"solid",onClick:()=>p()}]}});async function p(){await s.setValue.submit({domain:t.value}),d("customer-updated")}function a(e){s.setValue.submit({image:(e==null?void 0:e.file_url)||null}),d("customer-updated")}return(e,n)=>{const y=x("Button"),c=x("Input");return C(),R(o(E),{options:f.value},{"body-main":_(()=>{var $,w,B,S;return[i("div",oe,[i("div",te,T(($=o(s).doc)==null?void 0:$.name),1),r(o(M),{size:"lg",label:(w=o(s).doc)==null?void 0:w.name,image:(B=o(s).doc)==null?void 0:B.image,class:"cursor-pointer hover:opacity-80"},null,8,["label","image"]),i("div",ae,[r(o(G),{onSuccess:n[0]||(n[0]=v=>a(v))},{default:_(({uploading:v,openFileSelector:z})=>{var U;return[r(y,{label:(U=o(s).doc)!=null&&U.image?"Change photo":"Upload photo",loading:v,onClick:z},null,8,["label","loading","onClick"])]}),_:1}),(S=o(s).doc)!=null&&S.image?(C(),R(y,{key:0,label:o(l)("Remove photo"),onClick:n[1]||(n[1]=v=>a(null))},null,8,["label"])):H("",!0)]),i("form",{class:"w-full",onSubmit:I(p,["prevent"])},[r(c,{modelValue:t.value,"onUpdate:modelValue":n[2]||(n[2]=v=>t.value=v),label:o(l)("Domain"),placeholder:o(l)("example.com")},null,8,["modelValue","label","placeholder"])],32)])]}),_:1},8,["options"])}}}),se={class:"flex flex-col"},ne={key:0},we=D({__name:"Customers",setup(V){const m=b(!1),u=b(!1),d=b(null),t=b(null);function s(a){d.value=a,u.value=!0}function f(a=!1){var e;a?u.value=!1:m.value=!1,(e=t.value)==null||e.reload()}const p=k(()=>({doctype:"HD Customer",selectable:!0,showSelectBanner:!0,columnConfig:{name:{prefix:({row:a})=>K(M,{shape:"circle",image:a.image,label:a.name,size:"sm"})}},emptyState:{title:l("No Customers Found")}}));return j(()=>({title:l("Customers")})),(a,e)=>{const n=O,y=x("Button");return C(),h("div",se,[r(Q,null,{"left-header":_(()=>[...e[5]||(e[5]=[i("div",{class:"text-lg font-medium text-gray-900"},"Customers",-1)])]),"right-header":_(()=>[r(y,{label:o(l)("New customer"),theme:"gray",variant:"solid",onClick:e[0]||(e[0]=c=>m.value=!m.value)},{prefix:_(()=>[r(n,{class:"h-4 w-4"})]),_:1},8,["label"])]),_:1}),r(W,{ref_key:"listViewRef",ref:t,options:p.value,onRowClick:s,onEmptyStateAction:e[1]||(e[1]=c=>m.value=!0)},null,8,["options"]),r(ee,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=c=>m.value=c),onCustomerCreated:f},null,8,["modelValue"]),u.value?(C(),h("span",ne,[r(le,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=c=>u.value=c),name:d.value,onCustomerUpdated:e[4]||(e[4]=c=>f(!0))},null,8,["modelValue","name"])])):H("",!0)])}}});export{we as default};
//# sourceMappingURL=Customers-759ee75a.js.map
