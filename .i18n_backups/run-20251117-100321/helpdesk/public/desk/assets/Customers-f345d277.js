import{d as D,m as A,n as q,p as F,W as L,Q as g,k as h,g as n,w as _,h as o,r as x,e as C,l as i,bh as N,q as r,z as I,I as E,c as k,au as P,f as R,v as T,y as H,A as b,K,S as O}from"./index-70619bb5.js";import{L as Q}from"./LayoutHeader-330b6449.js";import{_ as W}from"./ListViewBuilder.vue_vue_type_script_setup_true_lang-8d08270a.js";import{_ as M}from"./Avatar.vue_vue_type_script_setup_true_lang-e2ccf576.js";import{u as j}from"./pageMeta-8fdb5c1e.js";import{F as G}from"./FileUploader-0ea47db7.js";import"./Dropdown-19778bff.js";import"./TabButtons-7d8e5c5a.js";import"./description-7d12a55f.js";import"./TypingIndicator.vue_vue_type_style_index_0_scoped_3f215bd3_lang-b030ea09.js";import"./dayjs-5868d221.js";import"./DateTimePicker-e0783882.js";import"./useDatePicker-f8eb2ea6.js";import"./DateRangePicker.vue_vue_type_script_setup_true_lang-37cbfe72.js";import"./Link-fff2e6d4.js";import"./StarRating.vue_vue_type_script_setup_true_lang-5b0e6a21.js";import"./NestedPopover-1ff912a7.js";import"./portal-399ac095.js";import"./MultipleAvatar.vue_vue_type_script_setup_true_lang-7d84c5a1.js";import"./ticketStatus-b324718d.js";const J={class:"space-y-4"},X={class:"space-y-1"},Y={class:"space-y-1"},Z={class:"float-right flex space-x-2"},ee=D({__name:"NewCustomerDialog",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:A(["customerCreated"],["update:modelValue"]),setup(V,{emit:m}){const u=m,d=q(V,"modelValue"),t=F({customer:"",domain:""}),l=L({url:"frappe.client.insert",method:"POST",data:{doc:{doctype:"HD Customer",customer_name:t.customer,domain:t.domain}},onSuccess:()=>{t.customer="",t.domain="",g.success("Customer created"),u("customerCreated")},onError:p=>{g.error(p.messages[0])}});function f(){if(!t.customer){g.error("Customer name is required");return}l.submit({doc:{doctype:"HD Customer",customer_name:t.customer,domain:t.domain}})}return(p,a)=>{const e=x("Button");return C(),h("div",null,[n(o(E),{modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=s=>d.value=s),options:{title:"Add New Customer",size:"sm"}},{"body-content":_(()=>[i("div",J,[i("div",X,[n(o(N),{modelValue:t.customer,"onUpdate:modelValue":a[0]||(a[0]=s=>t.customer=s),label:o(r)("Customer Name"),type:"text",placeholder:o(r)("Tesla Inc.")},null,8,["modelValue","label","placeholder"])]),i("div",Y,[n(o(N),{modelValue:t.domain,"onUpdate:modelValue":a[1]||(a[1]=s=>t.domain=s),label:o(r)("Domain"),type:"text",placeholder:o(r)("eg: tesla.com, mycompany.com")},null,8,["modelValue","label","placeholder"])]),i("div",Z,[n(e,{label:o(r)("Add"),theme:"gray",variant:"solid",onClick:I(f,["prevent"])},null,8,["label"])])])]),_:1},8,["modelValue"])])}}}),oe={class:"flex flex-col items-center gap-4 p-6"},te={class:"text-xl font-medium text-gray-900"},ae={class:"flex gap-2"},le=D({__name:"CustomerDialog",props:{name:{type:String,required:!0}},emits:["customer-updated"],setup(V,{emit:m}){const u=V,d=m,t=k({get(){var e;return(e=l.doc)==null?void 0:e.domain},set(e){l.doc.domain=e}}),l=P({doctype:"HD Customer",name:u.name,auto:!0,setValue:{onSuccess(){g.success("Customer updated")},onError(){g.error("Error updating customer")}}}),f=k(()=>{var e;return{title:(e=l.doc)==null?void 0:e.name,actions:[{label:r("Save"),theme:"gray",variant:"solid",onClick:()=>p()}]}});async function p(){await l.setValue.submit({domain:t.value}),d("customer-updated")}function a(e){l.setValue.submit({image:(e==null?void 0:e.file_url)||null}),d("customer-updated")}return(e,s)=>{const y=x("Button"),c=x("Input");return C(),R(o(E),{options:f.value},{"body-main":_(()=>{var $,w,B,S;return[i("div",oe,[i("div",te,T(($=o(l).doc)==null?void 0:$.name),1),n(o(M),{size:"lg",label:(w=o(l).doc)==null?void 0:w.name,image:(B=o(l).doc)==null?void 0:B.image,class:"cursor-pointer hover:opacity-80"},null,8,["label","image"]),i("div",ae,[n(o(G),{onSuccess:s[0]||(s[0]=v=>a(v))},{default:_(({uploading:v,openFileSelector:z})=>{var U;return[n(y,{label:(U=o(l).doc)!=null&&U.image?"Change photo":"Upload photo",loading:v,onClick:z},null,8,["label","loading","onClick"])]}),_:1}),(S=o(l).doc)!=null&&S.image?(C(),R(y,{key:0,label:o(r)("Remove photo"),onClick:s[1]||(s[1]=v=>a(null))},null,8,["label"])):H("",!0)]),i("form",{class:"w-full",onSubmit:I(p,["prevent"])},[n(c,{modelValue:t.value,"onUpdate:modelValue":s[2]||(s[2]=v=>t.value=v),label:o(r)("Domain"),placeholder:o(r)("example.com")},null,8,["modelValue","label","placeholder"])],32)])]}),_:1},8,["options"])}}}),se={class:"flex flex-col"},ne={key:0},we=D({__name:"Customers",setup(V){const m=b(!1),u=b(!1),d=b(null),t=b(null);function l(a){d.value=a,u.value=!0}function f(a=!1){var e;a?u.value=!1:m.value=!1,(e=t.value)==null||e.reload()}const p=k(()=>({doctype:"HD Customer",selectable:!0,showSelectBanner:!0,columnConfig:{name:{prefix:({row:a})=>K(M,{shape:"circle",image:a.image,label:a.name,size:"sm"})}},emptyState:{title:r("No Customers Found")}}));return j(()=>({title:r("Customers")})),(a,e)=>{const s=O,y=x("Button");return C(),h("div",se,[n(Q,null,{"left-header":_(()=>[...e[5]||(e[5]=[i("div",{class:"text-lg font-medium text-gray-900"},"Customers",-1)])]),"right-header":_(()=>[n(y,{label:o(r)("New customer"),theme:"gray",variant:"solid",onClick:e[0]||(e[0]=c=>m.value=!m.value)},{prefix:_(()=>[n(s,{class:"h-4 w-4"})]),_:1},8,["label"])]),_:1}),n(W,{ref_key:"listViewRef",ref:t,options:p.value,onRowClick:l,onEmptyStateAction:e[1]||(e[1]=c=>m.value=!0)},null,8,["options"]),n(ee,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=c=>m.value=c),onCustomerCreated:f},null,8,["modelValue"]),u.value?(C(),h("span",ne,[n(le,{modelValue:u.value,"onUpdate:modelValue":e[3]||(e[3]=c=>u.value=c),name:d.value,onCustomerUpdated:e[4]||(e[4]=c=>f(!0))},null,8,["modelValue","name"])])):H("",!0)])}}});export{we as default};
//# sourceMappingURL=Customers-f345d277.js.map
